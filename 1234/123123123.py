"""
–ê–ù–ê–õ–ò–ó–ê–¢–û–† –¢–û–ù–ê–õ–¨–ù–û–°–¢–ò –¢–ï–ö–°–¢–û–í –° GUI –ò–ù–¢–ï–†–§–ï–ô–°–û–ú –ò –ü–†–û–í–ï–†–ö–û–ô –û–†–§–û–ì–†–ê–§–ò–ò
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç Tkinter (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Python)
"""

import tkinter as tk
from tkinter import ttk, scrolledtext, messagebox
import tkinter.font as tkfont
from collections import Counter
import re
import json
import os
import zipfile
import urllib.request
import difflib
from typing import List, Dict, Tuple, Set
import string


class SentimentAnalyzerGUI:
    """–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏"""

    # –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    POSITIVE_WORDS = {
        '—Ö–æ—Ä–æ—à–∏–π', '–æ—Ç–ª–∏—á–Ω—ã–π', '–ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π', '–∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–π', '–≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π',
        '—É–¥–æ–±–Ω—ã–π', '–ø—Ä–æ—Å—Ç–æ–π', '–ª–µ–≥–∫–∏–π', '–ø–æ–Ω—è—Ç–Ω—ã–π', '–∫–ª–∞—Å—Å–Ω—ã–π', '—Å—É–ø–µ—Ä',
        '–æ—Ç–ª–∏—á–Ω–æ', '—Ö–æ—Ä–æ—à–æ', '–ø—Ä–µ–∫—Ä–∞—Å–Ω–æ', '–∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ', '–≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ',
        '–ª—é–±–ª—é', '–Ω—Ä–∞–≤–∏—Ç—Å—è', '–æ–±–æ–∂–∞—é', '–≤–æ—Å—Ö–∏—â–∞—é—Å—å', '—Ä–µ–∫–æ–º–µ–Ω–¥—É—é',
        '—Å–ø–∞—Å–∏–±–æ', '–±–ª–∞–≥–æ–¥–∞—Ä—é', '—Ä–∞–¥', '—Å—á–∞—Å—Ç–ª–∏–≤', '–¥–æ–≤–æ–ª–µ–Ω', '—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω',
        '–ª—É—á—à–∏–π', '–∏–¥–µ–∞–ª—å–Ω—ã–π', '–±–µ—Å–ø–æ–¥–æ–±–Ω—ã–π', '–Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–π', '–ø–æ–ª–µ–∑–Ω—ã–π',
        '—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π', '–±—ã—Å—Ç—Ä—ã–π', '–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π', '–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π',
        '–≤–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω—ã–π', '–ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–π', '–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–π', '—Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π',
        '–Ω–∞–¥–µ–∂–Ω—ã–π', '—Å—Ç–∞–±–∏–ª—å–Ω—ã–π', '–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π', '–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π'
    }

    NEGATIVE_WORDS = {
        '–ø–ª–æ—Ö–æ–π', '—É–∂–∞—Å–Ω—ã–π', '–æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω—ã–π', '–∫–æ—à–º–∞—Ä–Ω—ã–π', '—Å–∫—É—á–Ω—ã–π',
        '—Å–ª–æ–∂–Ω—ã–π', '—Ç—Ä—É–¥–Ω—ã–π', '–Ω–µ—É–¥–æ–±–Ω—ã–π', '–Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–π', '—Å–ª–∞–±—ã–π',
        '–ø–ª–æ—Ö–æ', '—É–∂–∞—Å–Ω–æ', '–æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–æ', '–∫–æ—à–º–∞—Ä–Ω–æ', '—Å–∫—É—á–Ω–æ',
        '–Ω–µ–Ω–∞–≤–∏–∂—É', '–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è', '—Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω', '–∂–∞–ª—å', '–ø–µ—á–∞–ª—å–Ω–æ',
        '–≥—Ä—É—Å—Ç–Ω–æ', '–∑–ª–æ–π', '—Å–µ—Ä–¥–∏—Ç', '—Ä–∞–∑–æ–∑–ª–µ–Ω', '–Ω–µ–¥–æ–≤–æ–ª–µ–Ω',
        '—Ö—É–¥—à–∏–π', '—É–∂–∞—Å–Ω–µ–π—à–∏–π', '–æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–µ–π—à–∏–π', '–±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π',
        '–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π', '–º–µ–¥–ª–µ–Ω–Ω—ã–π', '–Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π', '–Ω–µ–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π',
        '—É–∂–∞—Å–∞—é—â–∏–π', '–æ—Ç–≤—Ä–∞—Ç–Ω—ã–π', '–º–µ—Ä–∑–∫–∏–π', '–ø–∞—Ä—à–∏–≤—ã–π', '–Ω–∏–∫—É–¥—ã—à–Ω—ã–π',
        '–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã–π', '–±—Ä–∞–∫–æ–≤–∞–Ω–Ω—ã–π', '–¥–µ—Ñ–µ–∫—Ç–Ω—ã–π', '–Ω–∏–∑–∫–æ—Å–æ—Ä—Ç–Ω—ã–π'
    }

    INTENSIFIERS = {
        '–æ—á–µ–Ω—å': 1.5,
        '–∫—Ä–∞–π–Ω–µ': 2.0,
        '—á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ': 2.0,
        '–Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ': 2.0,
        '–Ω–µ–æ–±—ã—á–∞–π–Ω–æ': 1.8,
        '–æ—Å–æ–±–µ–Ω–Ω–æ': 1.3,
        '–¥–æ–≤–æ–ª—å–Ω–æ': 1.2,
        '–≤–µ—Å—å–º–∞': 1.2,
        '—Å–ª–∏—à–∫–æ–º': 1.5,
        '–∞–±—Å–æ–ª—é—Ç–Ω–æ': 1.8,
        '—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ': 1.8,
        '–ø–æ–ª–Ω–æ—Å—Ç—å—é': 1.5,
        '–Ω–µ–∏–º–æ–≤–µ—Ä–Ω–æ': 1.9,
        '–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ': 1.6
    }

    NEGATIONS = {'–Ω–µ', '–Ω–µ—Ç', '–Ω–∏', '–±–µ–∑', '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç', '–Ω–∏–∫–∞–∫'}

    # –†—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    RUSSIAN_LETTERS = set('–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è')

    def __init__(self, root):
        self.root = root
        self.root.title("–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏")
        self.root.geometry("1100x750")
        self.root.configure(bg='#f0f0f0')

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π
        self.setup_styles()

        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
        self.results = []
        
        # –°–ª–æ–≤–∞—Ä—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.spell_dict = set()
        
        # –°–ª–æ–≤–∞ —Å –æ—à–∏–±–∫–∞–º–∏ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞
        self.current_misspelled_words = []
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.load_spell_dictionary()

        # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        self.create_widgets()

    def setup_styles(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª–µ–π –¥–ª—è –≤–∏–¥–∂–µ—Ç–æ–≤"""
        self.style = ttk.Style()

        # –¶–≤–µ—Ç–∞
        self.COLORS = {
            'bg': '#f0f0f0',
            'positive': '#4CAF50',
            'negative': '#F44336',
            'neutral': '#2196F3',
            'light_bg': '#ffffff',
            'border': '#cccccc',
            'text': '#333333',
            'spelling_error': '#FF5722',
            'spelling_correct': '#4CAF50',
            'warning': '#FF9800'
        }

    def load_spell_dictionary(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏"""
        try:
            # –°–æ–∑–¥–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å
            self.spell_dict = set()
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–≤–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä–µ–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
            self.spell_dict.update(self.POSITIVE_WORDS)
            self.spell_dict.update(self.NEGATIVE_WORDS)
            self.spell_dict.update(self.INTENSIFIERS.keys())
            self.spell_dict.update(self.NEGATIONS)
            
            # –î–æ–±–∞–≤–ª—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ä—É—Å—Å–∫–∏–µ —Å–ª–æ–≤–∞ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
            basic_russian_words = self.get_extended_russian_words()
            self.spell_dict.update(basic_russian_words)
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–≤–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö
            self.add_word_variations()
            
            print(f"–ó–∞–≥—Ä—É–∂–µ–Ω —Å–ª–æ–≤–∞—Ä—å: {len(self.spell_dict)} —Å–ª–æ–≤")
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ª–æ–≤–∞—Ä—è: {e}")
            # –°–æ–∑–¥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å
            self.spell_dict = self.POSITIVE_WORDS.union(self.NEGATIVE_WORDS)

    def get_extended_russian_words(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Ä—É—Å—Å–∫–∏—Ö —Å–ª–æ–≤"""
        return {
            # –û—Å–Ω–æ–≤–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã
            '–±—ã—Ç—å', '–µ—Å—Ç—å', '–±—ã–ª', '–±—ã–ª–∞', '–±—ã–ª–æ', '–±—ã–ª–∏',
            '–¥–µ–ª–∞—Ç—å', '–¥–µ–ª–∞—é', '–¥–µ–ª–∞–µ—Ç', '–¥–µ–ª–∞–µ–º', '–¥–µ–ª–∞–µ—Ç–µ', '–¥–µ–ª–∞—é—Ç',
            '—Å–∫–∞–∑–∞—Ç—å', '–≥–æ–≤–æ—Ä—é', '–≥–æ–≤–æ—Ä–∏—Ç', '–≥–æ–≤–æ—Ä–∏–º', '–≥–æ–≤–æ—Ä–∏—Ç–µ', '–≥–æ–≤–æ—Ä—è—Ç',
            '–º–æ—á—å', '–º–æ–≥—É', '–º–æ–∂–µ—Ç', '–º–æ–∂–µ–º', '–º–æ–∂–µ—Ç–µ', '–º–æ–≥—É—Ç',
            '–∑–Ω–∞—Ç—å', '–∑–Ω–∞—é', '–∑–Ω–∞–µ—Ç', '–∑–Ω–∞–µ–º', '–∑–Ω–∞–µ—Ç–µ', '–∑–Ω–∞—é—Ç',
            '—Ö–æ—Ç–µ—Ç—å', '—Ö–æ—á—É', '—Ö–æ—á–µ—Ç', '—Ö–æ—Ç–∏–º', '—Ö–æ—Ç–∏—Ç–µ', '—Ö–æ—Ç—è—Ç',
            '–∏–¥—Ç–∏', '–∏–¥—É', '–∏–¥—ë—Ç', '–∏–¥—ë–º', '–∏–¥—ë—Ç–µ', '–∏–¥—É—Ç',
            '–≤–∏–¥–µ—Ç—å', '–≤–∏–∂—É', '–≤–∏–¥–∏—Ç', '–≤–∏–¥–∏–º', '–≤–∏–¥–∏—Ç–µ', '–≤–∏–¥—è—Ç',
            '–¥—É–º–∞—Ç—å', '–¥—É–º–∞—é', '–¥—É–º–∞–µ—Ç', '–¥—É–º–∞–µ–º', '–¥—É–º–∞–µ—Ç–µ', '–¥—É–º–∞—é—Ç',
            '–∂–∏—Ç—å', '–∂–∏–≤—É', '–∂–∏–≤—ë—Ç', '–∂–∏–≤—ë–º', '–∂–∏–≤—ë—Ç–µ', '–∂–∏–≤—É—Ç',
            '–ª—é–±–∏—Ç—å', '–ª—é–±–ª—é', '–ª—é–±–∏—Ç', '–ª—é–±–∏–º', '–ª—é–±–∏—Ç–µ', '–ª—é–±—è—Ç',
            
            # –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ
            '—á–µ–ª–æ–≤–µ–∫','—Ç–µ–∫—Å—Ç', '–≤—Ä–µ–º—è', '–¥–µ–ª–æ', '–∂–∏–∑–Ω—å', '–¥–µ–Ω—å', '—Ä—É–∫–∞', '—Ä–∞–±–æ—Ç–∞',
            '—Å–ª–æ–≤–æ', '–º–µ—Å—Ç–æ', '–ª–∏—Ü–æ', '–¥—Ä—É–≥', '–≥–ª–∞–∑', '–≤–æ–ø—Ä–æ—Å', '–¥–æ–º',
            '—Å—Ç–æ—Ä–æ–Ω–∞', '—Å—Ç—Ä–∞–Ω–∞', '–º–∏—Ä', '—Å–ª—É—á–∞–π', '–≥–æ–ª–æ–≤–∞', '—Ä–µ–±–µ–Ω–æ–∫',
            '—Å–∏–ª–∞', '–∫–æ–Ω–µ—Ü', '–≤–∏–¥', '—Å–∏—Å—Ç–µ–º–∞', '—á–∞—Å—Ç—å', '–≥–æ—Ä–æ–¥', '–æ—Ç–Ω–æ—à–µ–Ω–∏–µ',
            '–∂–µ–Ω—â–∏–Ω–∞', '–¥–µ–Ω—å–≥–∏', '–∑–µ–º–ª—è', '–º–∞—à–∏–Ω–∞', '–≤–æ–¥–∞', '–æ—Ç–µ—Ü', '–ø—Ä–æ–±–ª–µ–º–∞',
            '—á–∞—Å', '–ø—Ä–∞–≤–æ', '–Ω–æ–≥–∞', '—Ä–µ—à–µ–Ω–∏–µ', '–¥–≤–µ—Ä—å', '–æ–±—Ä–∞–∑', '–∏—Å—Ç–æ—Ä–∏—è',
            '–≤–ª–∞—Å—Ç—å', '–∑–∞–∫–æ–Ω', '–≤–æ–π–Ω–∞', '–±–æ–≥', '–≥–æ–ª–æ—Å', '—Ç—ã—Å—è—á–∞', '–∫–Ω–∏–≥–∞',
            '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç', '–Ω–æ—á—å', '—Å—Ç–æ–ª', '–∏–º—è', '–æ–±–ª–∞—Å—Ç—å',
            '—Å—Ç–∞—Ç—å—è', '—á–∏—Å–ª–æ', '–∫–æ–º–ø–∞–Ω–∏—è', '–Ω–∞—Ä–æ–¥', '–∂–µ–Ω–∞', '–≥—Ä—É–ø–ø–∞',
            '—Ä–∞–∑–≤–∏—Ç–∏–µ', '–ø—Ä–æ—Ü–µ—Å—Å', '—Å—É–¥', '—É—Å–ª–æ–≤–∏–µ', '—Å—Ä–µ–¥—Å—Ç–≤–æ', '–Ω–∞—á–∞–ª–æ',
            '—Å–≤–µ—Ç', '–ø–æ—Ä–∞', '–ø—É—Ç—å', '–¥—É—à–∞', '—É—Ä–æ–≤–µ–Ω—å', '—Ñ–æ—Ä–º–∞', '—Å–≤—è–∑—å',
            '–º–∏–Ω—É—Ç–∞', '—É–ª–∏—Ü–∞', '–≤–µ—á–µ—Ä', '–∫–∞—á–µ—Å—Ç–≤–æ', '–º—ã—Å–ª—å', '–¥–æ—Ä–æ–≥–∞',
            '–º–∞—Ç—å', '–¥–µ–π—Å—Ç–≤–∏–µ', '–º–µ—Å—è—Ü', '–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ', '—è–∑—ã–∫', '–ª—é–±–æ–≤—å',
            '–≤–∑–≥–ª—è–¥', '–º–∞–º–∞', '–≤–µ–∫', '—à–∫–æ–ª–∞', '—Ü–µ–ª—å', '–æ–±—â–µ—Å—Ç–≤–æ', '–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
            '–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è', '–ø—Ä–µ–∑–∏–¥–µ–Ω—Ç', '–∫–æ–º–Ω–∞—Ç–∞', '–ø–æ—Ä—è–¥–æ–∫', '–º–æ–º–µ–Ω—Ç',
            '—Ç–µ–∞—Ç—Ä', '–ø–∏—Å—å–º–æ', '—É—Ç—Ä–æ', '–ø–æ–º–æ—â—å', '—Å–∏—Ç—É–∞—Ü–∏—è', '—Ä–æ–ª—å',
            '—Ä—É–±–ª—å', '—Å–º—ã—Å–ª', '—Å–æ—Å—Ç–æ—è–Ω–∏–µ', '–∫–≤–∞—Ä—Ç–∏—Ä–∞', '–æ—Ä–≥–∞–Ω', '–≤–Ω–∏–º–∞–Ω–∏–µ',
            '—Ç–µ–ª–æ', '—Ç—Ä—É–¥', '—Å—ã–Ω', '–º–µ—Ä–∞', '—Å–º–µ—Ä—Ç—å', '—Ä—ã–Ω–æ–∫', '–ø—Ä–æ–≥—Ä–∞–º–º–∞',
            '–∑–∞–¥–∞—á–∞', '–ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ', '–æ–∫–Ω–æ', '—Ä–∞–∑–≥–æ–≤–æ—Ä', '–ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ',
            '—Å–µ–º—å—è', '–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', '–ø–æ–ª–æ–∂–µ–Ω–∏–µ', '—Ü–µ–Ω—Ç—Ä',
            '–æ—Ç–≤–µ—Ç', '–º—É–∂', '–∞–≤—Ç–æ—Ä', '—Å—Ç–µ–Ω–∞', '–∏–Ω—Ç–µ—Ä–µ—Å', '—Ñ–µ–¥–µ—Ä–∞—Ü–∏—è',
            '–ø—Ä–∞–≤–∏–ª–æ', '—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', '–º—É–∂—á–∏–Ω–∞', '–∏–¥–µ—è', '–ø–∞—Ä—Ç–∏—è', '—Å–æ–≤–µ—Ç',
            '—Å—á–µ—Ç', '—Å–µ—Ä–¥—Ü–µ', '–¥–≤–∏–∂–µ–Ω–∏–µ', '–≤–µ—â—å', '–º–∞—Ç–µ—Ä–∏–∞–ª', '–Ω–µ–¥–µ–ª—è',
            '—á—É–≤—Å—Ç–≤–æ', '–≥–ª–∞–≤–∞', '–Ω–∞—É–∫–∞', '—Ä—è–¥', '–≥–∞–∑–µ—Ç–∞', '–ø—Ä–∏—á–∏–Ω–∞',
            '–ø–ª–µ—á–æ', '—Ü–µ–Ω–∞', '–ø–ª–∞–Ω', '—Ä–µ—á—å', '—Ç–æ—á–∫–∞', '–æ—Å–Ω–æ–≤–∞', '—Ç–æ–≤–∞—Ä–∏—â',
            '–∫—É–ª—å—Ç—É—Ä–∞', '–¥–∞–Ω–Ω—ã–µ', '–º–Ω–µ–Ω–∏–µ', '–¥–æ–∫—É–º–µ–Ω—Ç', '–∏–Ω—Å—Ç–∏—Ç—É—Ç',
            '—Ö–æ–¥', '–ø—Ä–æ–µ–∫—Ç', '–≤—Å—Ç—Ä–µ—á–∞', '–¥–∏—Ä–µ–∫—Ç–æ—Ä', '—Å—Ä–æ–∫', '–ø–∞–ª–µ—Ü',
            '–æ–ø—ã—Ç', '—Å–ª—É–∂–±–∞', '—Å—É–¥—å–±–∞', '–¥–µ–≤—É—à–∫–∞', '–æ—á–µ—Ä–µ–¥—å', '–ª–µ—Å',
            '—Å–æ—Å—Ç–∞–≤', '—á–ª–µ–Ω', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '—Å–æ–±—ã—Ç–∏–µ', '–æ–±—ä–µ–∫—Ç',
            '–∑–∞–ª', '—Å–æ–∑–¥–∞–Ω–∏–µ', '–∑–Ω–∞—á–µ–Ω–∏–µ', '–ø–µ—Ä–∏–æ–¥', '—à–∞–≥', '–±—Ä–∞—Ç',
            '–∏—Å–∫—É—Å—Å—Ç–≤–æ', '—Å—Ç—Ä—É–∫—Ç—É—Ä–∞', '–Ω–æ–º–µ—Ä', '–ø—Ä–∏–º–µ—Ä', '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ',
            '–≥—Ä–∞–∂–¥–∞–Ω–∏–Ω', '–∏–≥—Ä–∞', '–Ω–∞—á–∞–ª—å–Ω–∏–∫', '—Ä–æ—Å—Ç', '—Ç–µ–º–∞', '–ø—Ä–∏–Ω—Ü–∏–ø',
            '–º–µ—Ç–æ–¥', '—Ç–∏–ø', '—Ñ–∏–ª—å–º', '–∫—Ä–∞–π', '–≥–æ—Å—Ç—å', '–≤–æ–∑–¥—É—Ö','—ç—Ç–æ','–ø—Ä–æ–¥—É–∫—Ç','–ø–æ–∫—É–ø–∫–æ–π','–ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å',
            
            # –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ
            '–Ω–æ–≤—ã–π', '—Å—Ç–∞—Ä—ã–π', '–±–æ–ª—å—à–æ–π', '–º–∞–ª–µ–Ω—å–∫–∏–π', '—Ö–æ—Ä–æ—à–∏–π', '–ø–ª–æ—Ö–æ–π',
            '–º–æ–ª–æ–¥–æ–π', '—Å—Ç–∞—Ä—ã–π', '–∫—Ä–∞—Å–∏–≤—ã–π', '—É–º–Ω—ã–π', '–≥–ª—É–ø—ã–π', '–±—ã—Å—Ç—Ä—ã–π',
            '–º–µ–¥–ª–µ–Ω–Ω—ã–π', '–¥–æ—Ä–æ–≥–æ–π', '–¥–µ—à–µ–≤—ã–π', '—Ç—è–∂–µ–ª—ã–π', '–ª–µ–≥–∫–∏–π', '–≤—ã—Å–æ–∫–∏–π',
            '–Ω–∏–∑–∫–∏–π', '–¥–ª–∏–Ω–Ω—ã–π', '–∫–æ—Ä–æ—Ç–∫–∏–π', '—à–∏—Ä–æ–∫–∏–π', '—É–∑–∫–∏–π', '–≥–ª—É–±–æ–∫–∏–π',
            '–º–µ–ª–∫–∏–π', '–≥–æ—Ä—è—á–∏–π', '—Ö–æ–ª–æ–¥–Ω—ã–π', '—Ç–µ–ø–ª—ã–π', '–ø—Ä–æ—Ö–ª–∞–¥–Ω—ã–π', '–≤–ª–∞–∂–Ω—ã–π',
            '—Å—É—Ö–æ–π', '—á–∏—Å—Ç—ã–π', '–≥—Ä—è–∑–Ω—ã–π', '—Å–≤–µ—Ç–ª—ã–π', '—Ç–µ–º–Ω—ã–π', '—è—Ä–∫–∏–π',
            '—Ç—É—Å–∫–ª—ã–π', '–≥—Ä–æ–º–∫–∏–π', '—Ç–∏—Ö–∏–π', '–º—è–≥–∫–∏–π', '—Ç–≤–µ—Ä–¥—ã–π', '–æ—Å—Ç—Ä—ã–π',
            '—Ç—É–ø–æ–π', '—Å–ª–∞–¥–∫–∏–π', '–≥–æ—Ä—å–∫–∏–π', '–∫–∏—Å–ª—ã–π', '—Å–æ–ª–µ–Ω—ã–π', '–ø—Ä—è–º–æ–π',
            '–∫—Ä–∏–≤–æ–π', '—Ä–æ–≤–Ω—ã–π', '–Ω–µ—Ä–æ–≤–Ω—ã–π', '–≥–ª–∞–¥–∫–∏–π', '—à–µ—Ä—à–∞–≤—ã–π', '–ø—É—Å—Ç–æ–π',
            '–ø–æ–ª–Ω—ã–π', '—Ç–æ–ª—Å—Ç—ã–π', '—Ç–æ–Ω–∫–∏–π', '–∫—Ä–µ–ø–∫–∏–π', '—Å–ª–∞–±—ã–π', '–∂–∏–≤–æ–π',
            '–º–µ—Ä—Ç–≤—ã–π', '–≤–µ—Å–µ–ª—ã–π', '–≥—Ä—É—Å—Ç–Ω—ã–π', '—Å–ø–æ–∫–æ–π–Ω—ã–π', '–≤–∑–≤–æ–ª–Ω–æ–≤–∞–Ω–Ω—ã–π',
            '–∑–¥–æ—Ä–æ–≤—ã–π', '–±–æ–ª—å–Ω–æ–π', '–±–æ–≥–∞—Ç—ã–π', '–±–µ–¥–Ω—ã–π', '—Å—á–∞—Å—Ç–ª–∏–≤—ã–π',
            '–Ω–µ—Å—á–∞—Å—Ç–Ω—ã–π', '–≤–∞–∂–Ω—ã–π', '–Ω–µ–≤–∞–∂–Ω—ã–π', '–∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π', '—Å–∫—É—á–Ω—ã–π',
            '–ø–æ–ª–µ–∑–Ω—ã–π', '–≤—Ä–µ–¥–Ω—ã–π', '–æ–ø–∞—Å–Ω—ã–π', '–±–µ–∑–æ–ø–∞—Å–Ω—ã–π', '–ª–µ–≥–∫–∏–π',
            '—Ç—Ä—É–¥–Ω—ã–π', '–ø—Ä–æ—Å—Ç–æ–π', '—Å–ª–æ–∂–Ω—ã–π', '—è—Å–Ω—ã–π', '–Ω–µ—è—Å–Ω—ã–π', '–≤–µ—Ä–Ω—ã–π',
            '–Ω–µ–≤–µ—Ä–Ω—ã–π', '–ø—Ä–∞–≤—ã–π', '–ª–µ–≤—ã–π', '–≤–µ—Ä—Ö–Ω–∏–π', '–Ω–∏–∂–Ω–∏–π', '–≤–Ω–µ—à–Ω–∏–π',
            '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π', '–¥–∞–ª—å–Ω–∏–π', '–±–ª–∏–∑–∫–∏–π', '—Ä–∞–Ω–Ω–∏–π', '–ø–æ–∑–¥–Ω–∏–π',
            '—Å–∫–æ—Ä—ã–π', '–º–µ–¥–ª–µ–Ω–Ω—ã–π', '—á–∞—Å—Ç—ã–π', '—Ä–µ–¥–∫–∏–π', '–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π',
            '–≤—Ä–µ–º–µ–Ω–Ω—ã–π', '–æ–±—â–∏–π', '—á–∞—Å—Ç–Ω—ã–π', '–ª–∏—á–Ω—ã–π', '–æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π',
            '–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π', '–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π', '–Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π', '–º–µ—Å—Ç–Ω—ã–π',
            '–≥–æ—Ä–æ–¥—Å–∫–æ–π', '—Å–µ–ª—å—Å–∫–∏–π', '–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π', '—Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–π',
            '—Ç–æ—Ä–≥–æ–≤—ã–π', '—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π', '–∫—É–ª—å—Ç—É—Ä–Ω—ã–π', '–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π',
            '–Ω–∞—É—á–Ω—ã–π', '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π', '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π', '—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π',
            '–≤–æ–µ–Ω–Ω—ã–π', '–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π', '—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π', '—Å–æ—Ü–∏–∞–ª—å–Ω—ã–π',
            '–¥—É—Ö–æ–≤–Ω—ã–π', '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π', '—Ñ–∏–∑–∏—á–µ—Å–∫–∏–π', '–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π',
            
            # –ù–∞—Ä–µ—á–∏—è –∏ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è
            '—ç—Ç–æ—Ç', '—Ç–æ—Ç', '—Ç–∞–∫–æ–π', '–∫–∞–∫–æ–π', '–∫–æ—Ç–æ—Ä—ã–π', '—á–µ–π', '—Å–∫–æ–ª—å–∫–æ',
            '—Å—Ç–æ–ª—å–∫–æ', '—Ç–∞–∫–æ–π', '—Å–µ–π', '–æ–Ω—ã–π', '–¥—Ä—É–≥–æ–π', '–∏–Ω–æ–π', '–Ω–µ–∫–æ—Ç–æ—Ä—ã–π',
            '–∫–∞–∫–æ–π-—Ç–æ', '–∫–æ–µ-–∫–∞–∫–æ–π', '–∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å', '–Ω–∏–∫–æ–π', '–Ω–∏–∫–∞–∫–æ–π',
            '–Ω–∏—á–µ–π', '–Ω–µ—á–µ–π', '–≤—Å—è–∫–∏–π', '–∫–∞–∂–¥—ã–π', '–ª—é–±–æ–π', '—Å–∞–º—ã–π',
            '—Å–∞–º', '—Å–∞–º–∞', '—Å–∞–º–æ', '—Å–∞–º–∏', '–≤–µ—Å—å', '–≤—Å—è', '–≤—Å—ë', '–≤—Å–µ',
            '–æ–Ω', '–æ–Ω–∞', '–æ–Ω–æ', '–æ–Ω–∏', '—è', '—Ç—ã', '–≤—ã', '–º—ã', '–≤—ã',
            '—Å–µ–±—è', '–º–æ–π', '—Ç–≤–æ–π', '–≤–∞—à', '–Ω–∞—à', '–µ–≥–æ', '–µ—ë', '–∏—Ö',
            '—Å–≤–æ–π', '–∫—Ç–æ', '—á—Ç–æ', '–∫–∞–∫–æ–π', '–∫–æ—Ç–æ—Ä—ã–π', '—á–µ–π', '—Å–∫–æ–ª—å–∫–æ',
            '–≥–¥–µ', '–∫—É–¥–∞', '–æ—Ç–∫—É–¥–∞', '–∫–æ–≥–¥–∞', '–∫–∞–∫', '–ø–æ—á–µ–º—É', '–∑–∞—á–µ–º',
            '–∑–¥–µ—Å—å', '—Ç–∞–º', '—Ç—É–¥–∞', '—Å—é–¥–∞', '–æ—Ç—Å—é–¥–∞', '–æ—Ç—Ç—É–¥–∞', '–≤–µ–∑–¥–µ',
            '–≤—Å—é–¥—É', '–Ω–∏–≥–¥–µ', '–Ω–∏–∫—É–¥–∞', '–Ω–∏–æ—Ç–∫—É–¥–∞', '–∫–æ–≥–¥–∞-—Ç–æ', '–∏–Ω–æ–≥–¥–∞',
            '–≤—Å–µ–≥–¥–∞', '–Ω–∏–∫–æ–≥–¥–∞', '–ø–æ—Ç–æ–º', '—Ç–µ–ø–µ—Ä—å', '—Å–µ–π—á–∞—Å', '—Ç–æ–≥–¥–∞',
            '–ø–æ—Å–ª–µ', '–¥–æ', '–ø–µ—Ä–µ–¥', '–º–µ–∂–¥—É', '–≤', '–Ω–∞', '–ø–æ–¥', '–Ω–∞–¥',
            '–∑–∞', '–ø–µ—Ä–µ–¥', '–æ–∫–æ–ª–æ', '–≤–æ–∑–ª–µ', '–≤–æ–∫—Ä—É–≥', '—Å–∫–≤–æ–∑—å', '—á–µ—Ä–µ–∑',
            '–≤–¥–æ–ª—å', '–ø–æ–ø–µ—Ä–µ–∫', '–ø—Ä–æ—Ç–∏–≤', '–±–µ–∑', '–¥–ª—è', '–¥–æ', '–∏–∑',
            '–∫', '–∫–æ', '–Ω–∞', '–æ', '–æ–±', '–æ—Ç', '–ø–æ', '–ø–æ–¥', '–ø—Ä–∏',
            '–ø—Ä–æ', '—Å', '—Å–æ', '—É', '—á–µ—Ä–µ–∑',
            
            # –ß–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ
            '–æ–¥–∏–Ω', '–¥–≤–∞', '—Ç—Ä–∏', '—á–µ—Ç—ã—Ä–µ', '–ø—è—Ç—å', '—à–µ—Å—Ç—å', '—Å–µ–º—å',
            '–≤–æ—Å–µ–º—å', '–¥–µ–≤—è—Ç—å', '–¥–µ—Å—è—Ç—å', '–æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—å', '–¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å',
            '—Ç—Ä–∏–Ω–∞–¥—Ü–∞—Ç—å', '—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å', '–ø—è—Ç–Ω–∞–¥—Ü–∞—Ç—å', '—à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç—å',
            '—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å', '–≤–æ—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å', '–¥–µ–≤—è—Ç–Ω–∞–¥—Ü–∞—Ç—å', '–¥–≤–∞–¥—Ü–∞—Ç—å',
            '—Ç—Ä–∏–¥—Ü–∞—Ç—å', '—Å–æ—Ä–æ–∫', '–ø—è—Ç—å–¥–µ—Å—è—Ç', '—à–µ—Å—Ç—å–¥–µ—Å—è—Ç', '—Å–µ–º—å–¥–µ—Å—è—Ç',
            '–≤–æ—Å–µ–º—å–¥–µ—Å—è—Ç', '–¥–µ–≤—è–Ω–æ—Å—Ç–æ', '—Å—Ç–æ', '–¥–≤–µ—Å—Ç–∏', '—Ç—Ä–∏—Å—Ç–∞',
            '—á–µ—Ç—ã—Ä–µ—Å—Ç–∞', '–ø—è—Ç—å—Å–æ—Ç', '—à–µ—Å—Ç—å—Å–æ—Ç', '—Å–µ–º—å—Å–æ—Ç', '–≤–æ—Å–µ–º—å—Å–æ—Ç',
            '–¥–µ–≤—è—Ç—å—Å–æ—Ç', '—Ç—ã—Å—è—á–∞', '–º–∏–ª–ª–∏–æ–Ω', '–º–∏–ª–ª–∏–∞—Ä–¥',
            
            # –ü—Ä–µ–¥–ª–æ–≥–∏ –∏ —Å–æ—é–∑—ã
            '–∏', '–∞', '–Ω–æ', '–∏–ª–∏', '—á—Ç–æ', '—á—Ç–æ–±—ã', '–∫–∞–∫', '–∫–æ–≥–¥–∞',
            '–≥–¥–µ', '–∫—É–¥–∞', '–æ—Ç–∫—É–¥–∞', '–ø–æ—á–µ–º—É', '–∑–∞—á–µ–º', '—Å–∫–æ–ª—å–∫–æ',
            '–Ω–∞—Å–∫–æ–ª—å–∫–æ', '—Å—Ç–æ–ª—å–∫–æ', '—Ç–∞–∫–æ–π', '–∫–∞–∫–æ–π', '–∫–æ—Ç–æ—Ä—ã–π',
            '—á–µ–π', '–∫–∞–∫-—Ç–æ', '–∫–æ–µ-–∫–∞–∫', '–∫–æ–µ-–≥–¥–µ', '–∫–æ–µ-–∫—É–¥–∞',
            '–∫–æ–µ-–∫–æ–≥–¥–∞', '–∫–æ–µ-–∫—Ç–æ', '–∫–æ–µ-—á—Ç–æ', '–∫–æ–µ-–∫–∞–∫–æ–π', '–∫–æ–µ-—á–µ–π',
            '–∫–æ–µ-—Å–∫–æ–ª—å–∫–æ', '–∫–æ–µ-–≥–¥–µ', '–∫–æ–µ-–∫—É–¥–∞', '–∫–æ–µ-–∫–æ–≥–¥–∞',
            '–≤', '–Ω–∞', '–ø–æ–¥', '–Ω–∞–¥', '–∑–∞', '–ø–µ—Ä–µ–¥', '–º–µ–∂–¥—É', '–æ–∫–æ–ª–æ',
            '–≤–æ–∑–ª–µ', '–≤–æ–∫—Ä—É–≥', '—Å–∫–≤–æ–∑—å', '—á–µ—Ä–µ–∑', '–≤–¥–æ–ª—å', '–ø–æ–ø–µ—Ä–µ–∫',
            '–ø—Ä–æ—Ç–∏–≤', '–±–µ–∑', '–¥–ª—è', '–¥–æ', '–∏–∑', '–∫', '–∫–æ', '–æ', '–æ–±',
            '–æ—Ç', '–ø–æ', '–ø—Ä–∏', '–ø—Ä–æ', '—Å', '—Å–æ', '—É', '—á–µ—Ä–µ–∑'
        }

    def add_word_variations(self):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞—Ü–∏–π —Å–ª–æ–≤ (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º—ã)"""
        variations = set()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–ª–æ–≤
        for word in list(self.spell_dict):
            if len(word) > 3:
                # –ë–∞–∑–æ–≤—ã–µ —Ñ–æ—Ä–º—ã (—É–±–∏—Ä–∞–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è)
                variations.add(word)
                
                # –î–ª—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö
                if word.endswith('—ã–π') or word.endswith('–∏–π') or word.endswith('–æ–π'):
                    variations.add(word[:-2])  # –û—Å–Ω–æ–≤–∞ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–≥–æ
                elif word.endswith('–∞—è'):
                    variations.add(word[:-2])
                elif word.endswith('–æ–µ'):
                    variations.add(word[:-2])
                elif word.endswith('–∏–µ'):
                    variations.add(word[:-2])
                elif word.endswith('—ã–µ'):
                    variations.add(word[:-2])
                elif word.endswith('—Ç—å'):  # –ì–ª–∞–≥–æ–ª—ã
                    variations.add(word[:-2])
                elif word.endswith('—Å—è'):
                    variations.add(word[:-2])
                    
        self.spell_dict.update(variations)

    def is_russian_word(self, word: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–ª–æ–≤–æ —Ä—É—Å—Å–∫–∏–º"""
        # –£–¥–∞–ª—è–µ–º –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é
        word_clean = word.strip(string.punctuation + '¬´¬ª""')
        
        if not word_clean:
            return False
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Å–ª–æ–≤–æ —Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã
        has_russian = any(char.lower() in self.RUSSIAN_LETTERS for char in word_clean)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–ª–æ–≤–æ —á–∏—Å–ª–æ–º –∏–ª–∏ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–æ–π –∏–∑ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤
        is_number = word_clean.replace(',', '').replace('.', '').isdigit()
        is_acronym = len(word_clean) > 1 and word_clean.isupper()
        
        return has_russian and not is_number and not is_acronym

    def check_spelling(self, text: str) -> Tuple[List[str], List[List[str]]]:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏ —Ç–µ–∫—Å—Ç–∞
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        - –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏
        - –°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞
        """
        if not text.strip():
            return [], []
        
        # –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞
        words = re.findall(r'\b[–∞-—è–ê-–Ø—ë–Å]+\b', text.lower())
        
        # –ù–∞—Ö–æ–¥–∏–º —Å–ª–æ–≤–∞ —Å –æ—à–∏–±–∫–∞–º–∏
        misspelled = []
        suggestions = []
        
        for word in words:
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–ª–æ–≤–∞
            if len(word) < 2:
                continue
                
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–ª–æ–≤–æ –≤ —Å–ª–æ–≤–∞—Ä–µ
            if word not in self.spell_dict:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–ª–æ–≤–∞
                word_lower = word.lower()
                found = False
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ—Ç —ç—Ç–æ —Ñ–æ—Ä–º–∞ —Å–ª–æ–≤–∞ —Å –¥—Ä—É–≥–æ–π —á–∞—Å—Ç—å—é —Ä–µ—á–∏
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 1-3 –±—É–∫–≤ (–æ–∫–æ–Ω—á–∞–Ω–∏—è)
                for i in range(1, 4):
                    if len(word_lower) > i + 2:
                        stem = word_lower[:-i]
                        if stem in self.spell_dict:
                            found = True
                            break
                
                if not found:
                    misspelled.append(word)
                    
                    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
                    word_suggestions = self.generate_suggestions(word)
                    suggestions.append(word_suggestions)
        
        return misspelled, suggestions

    def generate_suggestions(self, word: str, max_suggestions: int = 3) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–ª–æ–≤–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º difflib"""
        word_lower = word.lower()
        suggestions = []
        
        if not word_lower or len(word_lower) < 2:
            return suggestions
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º difflib –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö —Å–ª–æ–≤
        possible_matches = difflib.get_close_matches(
            word_lower, 
            list(self.spell_dict), 
            n=10,  # –ò—â–µ–º –±–æ–ª—å—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            cutoff=0.6  # –ë–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏
        )
        
        # –§–∏–ª—å—Ç—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        for match in possible_matches:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å –ø–æ –ø–µ—Ä–≤—ã–º –±—É–∫–≤–∞–º
            if word_lower[0] == match[0]:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É —Å–ª–æ–≤–∞
                if abs(len(word_lower) - len(match)) <= 3:
                    suggestions.append(match)
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, –∏—â–µ–º —Å–ª–æ–≤–∞ —Å –ø–æ—Ö–æ–∂–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
        if not suggestions:
            for dict_word in self.spell_dict:
                if len(dict_word) < 3:
                    continue
                    
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤
                if word_lower and dict_word and word_lower[0] == dict_word[0]:
                    # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∏
                    if self.is_similar(word_lower, dict_word):
                        suggestions.append(dict_word)
        
        # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
        suggestions = list(dict.fromkeys(suggestions))[:max_suggestions]
        
        return suggestions

    def is_similar(self, word1: str, word2: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–≤—É—Ö —Å–ª–æ–≤"""
        if not word1 or not word2:
            return False
            
        # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
        match_count = 0
        min_len = min(len(word1), len(word2))
        max_len = max(len(word1), len(word2))
        
        for i in range(min_len):
            if word1[i] == word2[i]:
                match_count += 1
        
        similarity = match_count / max_len if max_len > 0 else 0
        return similarity >= 0.6

    def create_widgets(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_frame = tk.Frame(self.root, bg=self.COLORS['bg'])
        title_frame.pack(fill=tk.X, padx=20, pady=(20, 10))

        title_label = tk.Label(
            title_frame,
            text="üìä –ê–ù–ê–õ–ò–ó–ê–¢–û–† –¢–û–ù–ê–õ–¨–ù–û–°–¢–ò –¢–ï–ö–°–¢–û–í –° –ü–†–û–í–ï–†–ö–û–ô –û–†–§–û–ì–†–ê–§–ò–ò",
            font=tkfont.Font(family="Arial", size=16, weight="bold"),
            bg=self.COLORS['bg'],
            fg=self.COLORS['text']
        )
        title_label.pack()

        subtitle_label = tk.Label(
            title_frame,
            text="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏",
            font=tkfont.Font(family="Arial", size=11),
            bg=self.COLORS['bg'],
            fg='#666666'
        )
        subtitle_label.pack(pady=(5, 0))

        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
        main_container = tk.Frame(self.root, bg=self.COLORS['bg'])
        main_container.pack(fill=tk.BOTH, expand=True, padx=20, pady=10)

        # –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (–≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞)
        left_panel = tk.Frame(main_container, bg=self.COLORS['light_bg'], relief=tk.RAISED, borderwidth=1)
        left_panel.pack(side=tk.LEFT, fill=tk.BOTH, expand=True, padx=(0, 10))

        # –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
        right_panel = tk.Frame(main_container, bg=self.COLORS['light_bg'], relief=tk.RAISED, borderwidth=1)
        right_panel.pack(side=tk.RIGHT, fill=tk.BOTH, expand=True, padx=(10, 0))

        # ===== –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ =====

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏
        left_title = tk.Label(
            left_panel,
            text="–í–í–û–î –¢–ï–ö–°–¢–ê",
            font=tkfont.Font(family="Arial", size=12, weight="bold"),
            bg=self.COLORS['light_bg'],
            fg=self.COLORS['text']
        )
        left_title.pack(pady=15)

        # –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
        input_frame = tk.Frame(left_panel, bg=self.COLORS['light_bg'])
        input_frame.pack(fill=tk.BOTH, expand=True, padx=15, pady=(0, 10))

        self.text_input = scrolledtext.ScrolledText(
            input_frame,
            height=12,
            width=40,
            font=tkfont.Font(family="Arial", size=11),
            wrap=tk.WORD,
            relief=tk.SUNKEN,
            borderwidth=2
        )
        self.text_input.pack(fill=tk.BOTH, expand=True)
        
        # –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.text_input.bind('<KeyRelease>', lambda e: self.root.after(500, self.on_text_change))

        # –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.spelling_status_label = tk.Label(
            input_frame,
            text="–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è: –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏",
            font=tkfont.Font(family="Arial", size=9),
            bg=self.COLORS['light_bg'],
            fg='#666666'
        )
        self.spelling_status_label.pack(anchor=tk.W, pady=(5, 0))

        # –ü—Ä–∏–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–æ–≤
        examples_frame = tk.Frame(left_panel, bg=self.COLORS['light_bg'])
        examples_frame.pack(fill=tk.X, padx=15, pady=(0, 10))

        examples_label = tk.Label(
            examples_frame,
            text="–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞ (—Å –æ—à–∏–±–∫–∞–º–∏):",
            font=tkfont.Font(family="Arial", size=10),
            bg=self.COLORS['light_bg'],
            fg='#666666'
        )
        examples_label.pack(anchor=tk.W)

        examples_buttons_frame = tk.Frame(examples_frame, bg=self.COLORS['light_bg'])
        examples_buttons_frame.pack(fill=tk.X, pady=(5, 0))

        example_texts = [
            ("üòä –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–π", "–≠—Ç–æ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–π –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç, —è –¥–æ–≤–æ–ª–µ–Ω –ø–æ–∫—É–ø–∫–æ–π! –û—á–µ–Ω—å –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å."),
            ("üò† –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π", "–£–∂–∞—Å–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –≤—Å–µ –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ –∏ –Ω–µ—É–¥–æ–±–Ω–æ. –û—à–∏–±–∫–∏ –≤–µ–∑–¥–µ –∏ –≤—Å—é–¥—É."),
            ("üìù –° –æ—à–∏–±–∫–∞–º–∏", "–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å–∏—Ç–µ–º—ã.")
        ]

        for emoji, text in example_texts:
            btn = tk.Button(
                examples_buttons_frame,
                text=emoji,
                command=lambda t=text: self.load_example(t),
                font=tkfont.Font(family="Arial", size=9),
                bg='#e0e0e0',
                relief=tk.RAISED,
                borderwidth=1,
                cursor="hand2",
                width=15
            )
            btn.pack(side=tk.LEFT, padx=(0, 5), pady=2)

        # –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        buttons_frame = tk.Frame(left_panel, bg=self.COLORS['light_bg'])
        buttons_frame.pack(fill=tk.X, padx=15, pady=(0, 15))

        analyze_btn = tk.Button(
            buttons_frame,
            text="üîç –ê–ù–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨ –¢–ï–ö–°–¢",
            command=self.analyze_text,
            font=tkfont.Font(family="Arial", size=11, weight="bold"),
            bg=self.COLORS['positive'],
            fg='white',
            relief=tk.RAISED,
            borderwidth=2,
            padx=20,
            pady=10,
            cursor="hand2"
        )
        analyze_btn.pack(side=tk.LEFT, padx=(0, 10))

        clear_btn = tk.Button(
            buttons_frame,
            text="üóëÔ∏è –û–ß–ò–°–¢–ò–¢–¨",
            command=self.clear_text,
            font=tkfont.Font(family="Arial", size=10),
            bg='#ff9800',
            fg='white',
            relief=tk.RAISED,
            borderwidth=1,
            padx=15,
            pady=8,
            cursor="hand2"
        )
        clear_btn.pack(side=tk.LEFT)

        # ===== –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ =====

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏
        right_title = tk.Label(
            right_panel,
            text="–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê",
            font=tkfont.Font(family="Arial", size=12, weight="bold"),
            bg=self.COLORS['light_bg'],
            fg=self.COLORS['text']
        )
        right_title.pack(pady=15)

        # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        results_container = tk.Frame(right_panel, bg=self.COLORS['light_bg'])
        results_container.pack(fill=tk.BOTH, expand=True, padx=15, pady=(0, 15))

        # –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        top_results_frame = tk.Frame(results_container, bg=self.COLORS['light_bg'])
        top_results_frame.pack(fill=tk.X, pady=(0, 10))

        # –í–∏–¥–∂–µ—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
        self.sentiment_label = tk.Label(
            top_results_frame,
            text="–¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: --",
            font=tkfont.Font(family="Arial", size=14, weight="bold"),
            bg=self.COLORS['light_bg'],
            fg=self.COLORS['text']
        )
        self.sentiment_label.pack(anchor=tk.W)

        self.score_label = tk.Label(
            top_results_frame,
            text="–û—Ü–µ–Ω–∫–∞: 0.000",
            font=tkfont.Font(family="Arial", size=12),
            bg=self.COLORS['light_bg'],
            fg='#666666'
        )
        self.score_label.pack(anchor=tk.W, pady=(5, 0))

        # –¶–≤–µ—Ç–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
        self.sentiment_bar = tk.Canvas(
            top_results_frame,
            height=20,
            bg='#e0e0e0',
            highlightthickness=0
        )
        self.sentiment_bar.pack(fill=tk.X, pady=(10, 0))
        self.draw_sentiment_bar(0)  # –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

        # –ü–∞–Ω–µ–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        spelling_frame = tk.LabelFrame(
            results_container,
            text="–ü–†–û–í–ï–†–ö–ê –û–†–§–û–ì–†–ê–§–ò–ò",
            font=tkfont.Font(family="Arial", size=10, weight="bold"),
            bg=self.COLORS['light_bg'],
            fg=self.COLORS['text'],
            relief=tk.GROOVE,
            borderwidth=1
        )
        spelling_frame.pack(fill=tk.BOTH, padx=0, pady=(10, 0))

        # –ü–æ–ª–µ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.spelling_text = scrolledtext.ScrolledText(
            spelling_frame,
            height=5,
            width=40,
            font=tkfont.Font(family="Arial", size=10),
            wrap=tk.WORD,
            relief=tk.FLAT,
            borderwidth=0,
            state=tk.DISABLED
        )
        self.spelling_text.pack(fill=tk.BOTH, expand=True, padx=5, pady=5)

        # –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        details_frame = tk.LabelFrame(
            results_container,
            text="–î–ï–¢–ê–õ–ò –ê–ù–ê–õ–ò–ó–ê –¢–û–ù–ê–õ–¨–ù–û–°–¢–ò",
            font=tkfont.Font(family="Arial", size=10, weight="bold"),
            bg=self.COLORS['light_bg'],
            fg=self.COLORS['text'],
            relief=tk.GROOVE,
            borderwidth=1
        )
        details_frame.pack(fill=tk.BOTH, expand=True, padx=0, pady=(10, 0))

        # –ü–æ–ª–µ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        self.details_text = scrolledtext.ScrolledText(
            details_frame,
            height=8,
            width=40,
            font=tkfont.Font(family="Arial", size=10),
            wrap=tk.WORD,
            relief=tk.FLAT,
            borderwidth=0,
            state=tk.DISABLED
        )
        self.details_text.pack(fill=tk.BOTH, expand=True, padx=5, pady=5)

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats_frame = tk.Frame(results_container, bg=self.COLORS['light_bg'])
        stats_frame.pack(fill=tk.X, pady=(10, 0))

        self.stats_label = tk.Label(
            stats_frame,
            text="–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Ç–µ–∫—Å—Ç–æ–≤: 0",
            font=tkfont.Font(family="Arial", size=10),
            bg=self.COLORS['light_bg'],
            fg='#666666'
        )
        self.stats_label.pack(anchor=tk.W)

        # –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏
        clear_history_btn = tk.Button(
            stats_frame,
            text="üìä –û–ß–ò–°–¢–ò–¢–¨ –ò–°–¢–û–†–ò–Æ",
            command=self.clear_history,
            font=tkfont.Font(family="Arial", size=9),
            bg='#9E9E9E',
            fg='white',
            relief=tk.RAISED,
            borderwidth=1,
            padx=10,
            pady=5,
            cursor="hand2"
        )
        clear_history_btn.pack(anchor=tk.E, pady=(5, 0))

    def on_text_change(self):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏"""
        text = self.text_input.get(1.0, tk.END).strip()
        
        if not text or len(text) < 3:
            self.spelling_status_label.config(
                text="–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è: –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏",
                fg='#666666'
            )
            return
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é
        misspelled, suggestions = self.check_spelling(text)
        self.current_misspelled_words = misspelled
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        if not misspelled:
            word_count = len(text.split())
            self.spelling_status_label.config(
                text=f"‚úì –û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è: –æ—Ç–ª–∏—á–Ω–æ! –û—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ (—Å–ª–æ–≤: {word_count})",
                fg=self.COLORS['spelling_correct']
            )
        else:
            self.spelling_status_label.config(
                text=f"‚ö† –û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è: –Ω–∞–π–¥–µ–Ω–æ {len(misspelled)} –æ—à–∏–±–æ–∫",
                fg=self.COLORS['spelling_error']
            )

    def load_example(self, text):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–º–µ—Ä–∞ —Ç–µ–∫—Å—Ç–∞"""
        self.text_input.delete(1.0, tk.END)
        self.text_input.insert(1.0, text)
        # –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.on_text_change()

    def clean_text(self, text):
        """–û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"""
        text = text.lower()
        for char in '!?.,:;()[]{}"\'¬´¬ª':
            text = text.replace(char, ' ')
        return text

    def analyze_sentiment(self, text):
        """–û—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏"""
        original_text = text
        cleaned_text = self.clean_text(text)
        words = cleaned_text.split()

        if not words:
            return None

        score = 0
        positive_count = 0
        negative_count = 0
        positive_words = []
        negative_words = []

        i = 0
        while i < len(words):
            word = words[i]
            word_score = 0
            intensifier = 1.0

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–∏–ª–∏—Ç–µ–ª–∏
            if word in self.INTENSIFIERS and i + 1 < len(words):
                intensifier = self.INTENSIFIERS[word]
                i += 1
                if i >= len(words):
                    break
                word = words[i]

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç—Ä–∏—Ü–∞–Ω–∏—è
            is_negated = False
            if i > 0 and words[i - 1] in self.NEGATIONS:
                is_negated = True

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞
            if word in self.POSITIVE_WORDS:
                if is_negated:
                    word_score = -1 * intensifier
                    negative_count += 1
                    negative_words.append(f"–Ω–µ {word}")
                else:
                    word_score = 1 * intensifier
                    positive_count += 1
                    positive_words.append(word)

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞
            elif word in self.NEGATIVE_WORDS:
                if is_negated:
                    word_score = 1 * intensifier
                    positive_count += 1
                    positive_words.append(f"–Ω–µ {word}")
                else:
                    word_score = -1 * intensifier
                    negative_count += 1
                    negative_words.append(word)

            score += word_score
            i += 1

        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ü–µ–Ω–∫–∏
        total_words = len(words)
        normalized_score = score / total_words if total_words > 0 else 0

        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        if normalized_score > 0.2:
            sentiment = "–ü–û–ó–ò–¢–ò–í–ù–´–ô"
            color = self.COLORS['positive']
            emoji = "üòä"
        elif normalized_score > 0.05:
            sentiment = "–°–õ–ê–ë–û –ü–û–ó–ò–¢–ò–í–ù–´–ô"
            color = "#8BC34A"  # —Å–≤–µ—Ç–ª–æ–∑–µ–ª–µ–Ω—ã–π
            emoji = "üôÇ"
        elif normalized_score < -0.2:
            sentiment = "–ù–ï–ì–ê–¢–ò–í–ù–´–ô"
            color = self.COLORS['negative']
            emoji = "üò†"
        elif normalized_score < -0.05:
            sentiment = "–°–õ–ê–ë–û –ù–ï–ì–ê–¢–ò–í–ù–´–ô"
            color = "#FF9800"  # –æ—Ä–∞–Ω–∂–µ–≤—ã–π
            emoji = "üòê"
        else:
            sentiment = "–ù–ï–ô–¢–†–ê–õ–¨–ù–´–ô"
            color = self.COLORS['neutral']
            emoji = "üòê"

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        result = {
            'text': original_text[:200] + "..." if len(original_text) > 200 else original_text,
            'full_text': original_text,
            'score': round(score, 2),
            'normalized_score': round(normalized_score, 3),
            'sentiment': sentiment,
            'emoji': emoji,
            'color': color,
            'positive_words': positive_count,
            'negative_words': negative_count,
            'positive_list': positive_words[:10],  # –ø–µ—Ä–≤—ã–µ 10 —Å–ª–æ–≤
            'negative_list': negative_words[:10],
            'total_words': total_words,
            'char_count': len(original_text),
            'spelling_errors': len(self.current_misspelled_words)
        }

        return result

    def analyze_text(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –∞–Ω–∞–ª–∏–∑–∞"""
        text = self.text_input.get(1.0, tk.END).strip()

        if not text:
            messagebox.showwarning("–í–Ω–∏–º–∞–Ω–∏–µ", "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞!")
            return

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é
        misspelled, suggestions = self.check_spelling(text)
        
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        result = self.analyze_sentiment(text)

        if result is None:
            messagebox.showwarning("–í–Ω–∏–º–∞–Ω–∏–µ", "–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç!")
            return

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–∞—Ö
        result['misspelled_words'] = misspelled
        result['suggestions'] = suggestions
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        self.results.append(result)

        # –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        self.update_results_display(result)

        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        self.update_statistics()

    def update_results_display(self, result):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"""
        # –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç–∫–∏
        self.sentiment_label.config(
            text=f"{result['emoji']} –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: {result['sentiment']}",
            fg=result['color']
        )

        self.score_label.config(
            text=f"–û—Ü–µ–Ω–∫–∞: {result['normalized_score']} (—Å–ª–æ–≤: {result['total_words']}, —Å–∏–º–≤–æ–ª–æ–≤: {result['char_count']})"
        )

        # –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç–Ω—É—é —à–∫–∞–ª—É
        self.draw_sentiment_bar(result['normalized_score'])

        # –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        self.spelling_text.config(state=tk.NORMAL)
        self.spelling_text.delete(1.0, tk.END)
        
        if result['spelling_errors'] == 0:
            spelling_info = "‚úÖ –û–†–§–û–ì–†–ê–§–ò–Ø: –û–®–ò–ë–û–ö –ù–ï –ù–ê–ô–î–ï–ù–û\n\n"
            spelling_info += f"‚úì –í—Å–µ —Å–ª–æ–≤–∞ ({result['total_words']}) –Ω–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ."
            spelling_info += f"\n‚úì –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Å–ª–æ–≤ –∏–∑ —Å–ª–æ–≤–∞—Ä—è: {len(self.spell_dict)}"
        else:
            spelling_info = f"‚ö† –û–†–§–û–ì–†–ê–§–ò–Ø: –ù–ê–ô–î–ï–ù–û {result['spelling_errors']} –û–®–ò–ë–û–ö\n\n"
            spelling_info += "–°–ª–æ–≤–∞ —Å –æ—à–∏–±–∫–∞–º–∏:\n"
            
            for i, (word, word_suggestions) in enumerate(zip(result['misspelled_words'], result['suggestions'])):
                spelling_info += f"\n{i+1}. '{word}'"
                if word_suggestions:
                    spelling_info += f" ‚Üí {', '.join(word_suggestions[:3])}"
                else:
                    spelling_info += " (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–µ—Ç)"
            
            spelling_info += f"\n\n–°–æ–≤–µ—Ç: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∏—Ö —Å–ª–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ —Å–ª–æ–≤–∞—Ä—å."
        
        self.spelling_text.insert(1.0, spelling_info)
        self.spelling_text.config(state=tk.DISABLED)

        # –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
        self.details_text.config(state=tk.NORMAL)
        self.details_text.delete(1.0, tk.END)

        details = f"""üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê –¢–û–ù–ê–õ–¨–ù–û–°–¢–ò:
‚Ä¢ –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: {result['score']}
‚Ä¢ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞: {result['normalized_score']}
‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {result['sentiment']}

üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
‚Ä¢ –í—Å–µ–≥–æ —Å–ª–æ–≤: {result['total_words']}
‚Ä¢ –ü–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ–≤: {result['positive_words']}
‚Ä¢ –ù–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ–≤: {result['negative_words']}
‚Ä¢ –û—à–∏–±–æ–∫ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏: {result['spelling_errors']}

üîç –û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –°–õ–û–í–ê:"""
        
        if result['positive_list']:
            details += f"\n‚Ä¢ –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ: {', '.join(result['positive_list'])}"
        else:
            details += "\n‚Ä¢ –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

        if result['negative_list']:
            details += f"\n‚Ä¢ –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ: {', '.join(result['negative_list'])}"
        else:
            details += "\n‚Ä¢ –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ: –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

        self.details_text.insert(1.0, details)
        self.details_text.config(state=tk.DISABLED)

    def draw_sentiment_bar(self, score):
        """–†–∏—Å–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–Ω–æ–π —à–∫–∞–ª—ã —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏"""
        self.sentiment_bar.delete("all")

        width = self.sentiment_bar.winfo_width()
        if width < 10:  # –ï—Å–ª–∏ —Ö–æ–ª—Å—Ç –µ—â–µ –Ω–µ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω
            width = 300

        height = 20

        # –§–æ–Ω
        self.sentiment_bar.create_rectangle(0, 0, width, height, fill='#e0e0e0', outline='')

        # –¶–≤–µ—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Ü–µ–Ω–∫–∏
        # –û—Ü–µ–Ω–∫–∞ –æ—Ç -1 –¥–æ 1, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Ç 0 –¥–æ width
        center_x = width / 2
        bar_width = abs(score) * (width / 2)

        if score > 0:
            # –ü–æ–∑–∏—Ç–∏–≤–Ω–∞—è (–∑–µ–ª–µ–Ω–∞—è) —á–∞—Å—Ç—å
            x1 = center_x
            x2 = center_x + bar_width
            color = self.COLORS['positive']
        elif score < 0:
            # –ù–µ–≥–∞—Ç–∏–≤–Ω–∞—è (–∫—Ä–∞—Å–Ω–∞—è) —á–∞—Å—Ç—å
            x1 = center_x - bar_width
            x2 = center_x
            color = self.COLORS['negative']
        else:
            # –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è
            x1 = center_x - 1
            x2 = center_x + 1
            color = self.COLORS['neutral']

        self.sentiment_bar.create_rectangle(x1, 0, x2, height, fill=color, outline='')

        # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
        self.sentiment_bar.create_line(center_x, 0, center_x, height, fill='#333333', width=2)

        # –ü–æ–¥–ø–∏—Å–∏
        self.sentiment_bar.create_text(10, height / 2, text="-1 (–Ω–µ–≥–∞—Ç–∏–≤)", anchor=tk.W, fill='#666666',
                                       font=('Arial', 8))
        self.sentiment_bar.create_text(width - 10, height / 2, text="+1 (–ø–æ–∑–∏—Ç–∏–≤)", anchor=tk.E, fill='#666666',
                                       font=('Arial', 8))

        # –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        if abs(score) > 0.01:  # –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–ª—è –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            value_x = center_x + (score * width / 2)
            self.sentiment_bar.create_oval(value_x - 4, height / 2 - 4, value_x + 4, height / 2 + 4, fill='white',
                                           outline='#333333', width=2)

    def update_statistics(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        total = len(self.results)

        if total == 0:
            self.stats_label.config(text="–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Ç–µ–∫—Å—Ç–æ–≤: 0")
            return

        # –ü–æ–¥—Å—á–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        sentiments = [r['sentiment'] for r in self.results]
        pos_count = sum(1 for s in sentiments if '–ü–û–ó–ò–¢–ò–í' in s)
        neg_count = sum(1 for s in sentiments if '–ù–ï–ì–ê–¢–ò–í' in s)
        neu_count = total - pos_count - neg_count
        
        # –ü–æ–¥—Å—á–µ—Ç –æ—à–∏–±–æ–∫ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
        total_errors = sum(r['spelling_errors'] for r in self.results)

        self.stats_label.config(
            text=f"–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Ç–µ–∫—Å—Ç–æ–≤: {total} "
                 f"(üòä: {pos_count}, üòê: {neu_count}, üò†: {neg_count}) | "
                 f"–û—à–∏–±–æ–∫ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏: {total_errors}"
        )

    def clear_text(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞"""
        self.text_input.delete(1.0, tk.END)
        self.spelling_status_label.config(
            text="–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è: –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏",
            fg='#666666'
        )

    def clear_history(self):
        """–û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∞–Ω–∞–ª–∏–∑–∞"""
        if not self.results:
            messagebox.showinfo("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø—É—Å—Ç–∞!")
            return

        if messagebox.askyesno("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ", "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∞–Ω–∞–ª–∏–∑–∞?"):
            self.results = []

            # –°–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            self.sentiment_label.config(
                text="–¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: --",
                fg=self.COLORS['text']
            )
            self.score_label.config(text="–û—Ü–µ–Ω–∫–∞: 0.000")
            self.draw_sentiment_bar(0)
            
            self.spelling_text.config(state=tk.NORMAL)
            self.spelling_text.delete(1.0, tk.END)
            self.spelling_text.config(state=tk.DISABLED)

            self.details_text.config(state=tk.NORMAL)
            self.details_text.delete(1.0, tk.END)
            self.details_text.config(state=tk.DISABLED)

            self.update_statistics()

            messagebox.showinfo("–£—Å–ø–µ—Ö", "–ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–∞ –æ—á–∏—â–µ–Ω–∞!")


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    root = tk.Tk()
    app = SentimentAnalyzerGUI(root)

    # –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞
    root.update_idletasks()
    width = root.winfo_width()
    height = root.winfo_height()
    x = (root.winfo_screenwidth() // 2) - (width // 2)
    y = (root.winfo_screenheight() // 2) - (height // 2)
    root.geometry(f'{width}x{height}+{x}+{y}')

    # –ó–∞–ø—Ä–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
    root.resizable(True, True)

    root.mainloop()


if __name__ == "__main__":
    main()